<div class="container my-5">
  <div class="row">
    
    <%# --- グループ情報とアクション (左側: col-md-8) --- %>
    <div class="col-md-8 mb-4">
      <h2 class="h3 fw-bold mb-3"><%= @group.name %></h2>
      
      <div class="card p-4 shadow-sm mb-4">
        <h4 class="h5 fw-semibold border-bottom pb-2 mb-3">グループ概要</h4>
        <p class="text-secondary"><%= @group.introduction %></p>
        <p class="small text-muted mt-3">オーナー: <%= @group.owner.name %></p>
      </div>
      
      <%# ⭐ 参加/脱退/申請ボタンの条件分岐 (最重要ロジック) ⭐ %>
      <div class="mb-4">
        <% if @group.owner == current_member %>
          <%# 1. オーナーである場合 %>
          <%= link_to 'メンバー申請を確認', applications_group_path(@group), class: 'btn btn-warning me-2' %>
          <%= link_to 'グループ編集', edit_group_path(@group), class: 'btn btn-outline-info' %>
        
        <% elsif @is_member %>
          <%# 2. 承認済みメンバーである場合 %>
          <span class="badge bg-success me-2">参加済み</span>
          <%= link_to '脱退する', 
              group_group_members_path(@group), 
              method: :delete,                 
              data: { confirm: '本当に脱退しますか？' }, 
              class: 'btn btn-outline-danger' %>
          
        <% elsif @pending_application %>
          <%# 3. 参加申請中の場合 %>
          <span class="badge bg-secondary">申請中 (承認待ち)</span>
          <%# 申請を取り消すボタン（必要であれば実装） %>

        <% else %>
          <%# 4. 未参加の場合 %>
          <%= link_to 'グループに参加申請する', 
              group_group_members_path(@group), 
              method: :post,                     
              class: 'btn btn-primary btn-lg' %>
        <% end %>
      </div>
      
      <%# --- 最新の投稿など（必要に応じて）--- %>
      <h4 class="h5 fw-semibold border-bottom pb-2 mb-3 mt-5">グループ内の活動</h4>
      <%# TODO: @group.posts.latest.each ... など %>

    </div>
    
    <%# --- メンバー一覧 (右側: col-md-4) --- %>
    <div class="col-md-4">
      <div class="card shadow-sm p-3 bg-light sticky-top" style="top: 20px;">
        <h5 class="fw-bold mb-3">メンバー (<%= @group.members.count %> 名)</h5>
        <ul class="list-group list-group-flush">
          <% @group.members.each do |member| %>
            <li class="list-group-item d-flex align-items-center bg-light">
              <%# メンバーのアイコン画像（あれば） %>
              <i class="bi bi-person-circle fs-5 me-2"></i>
              <%= link_to member.name, member_path(member), class: "text-decoration-none" %>
              <% if member == @group.owner %>
                <span class="badge bg-dark ms-auto">オーナー</span>
              <% end %>
            </li>
          <% end %>
        </ul>
      </div>
    </div>
  </div>
</div>